"use strict";!function(e){var t=L.map("well-living-map",{renderer:L.canvas()}).setView([23.1,120.3],11),a=!1,o=void 0,n=void 0,r=void 0,i=void 0,l=void 0,s=void 0,c=void 0,p=void 0,d=void 0,g={color:"#E91E63",fillOpacity:.8,weight:0},f={color:"#8BC34A",fillOpacity:.8,weight:0},u={color:"#3F51B5",fillOpacity:.8,weight:0};t.scrollWheelZoom.disable(),L.tileLayer("http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",{maxZoom:18,minZoom:10,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(t);var m='<span><span class="info-block bg-liquefaction"></span><strong>土壤液化潛勢區</strong></span>\n                 <span><span class="info-block bg-water"></span><strong>淹水潛勢區</strong></span>';$("#map-info").append(m),$.getJSON("./src/data/disaster-liquefaction.json",function(e){n=e,c=L.geoJSON(n,{style:function(e){switch(e.properties["分級"]){case"低潛勢":f.fillOpacity=.5;break;case"中潛勢":f.fillOpacity=.7;break;case"高潛勢":f.fillOpacity=.9}return f}}).addTo(t)}),$.getJSON("./src/data/disaster-water600.json",function(e){r=e,i=L.geoJSON(r,{style:function(e){switch(e.properties.CLASS){case 1:u.fillOpacity=.5;break;case 2:u.fillOpacity=.7;break;case 3:u.fillOpacity=.9}return u}}).addTo(t)}),$.getJSON("./src/data/disaster-water200.json",function(e){l=L.geoJSON(e)}),$.getJSON("./src/data/disaster-country-water200.json",function(e){d=L.geoJSON(e)}),$.getJSON("./src/data/disaster-country-water600.json",function(e){p=L.geoJSON(e,{style:function(e){switch(e.properties.CLASS){case 1:u.fillOpacity=.5;break;case 2:u.fillOpacity=.7;break;case 3:u.fillOpacity=.9}return u}}).addTo(t)}),L.Control.geocoder({collapsed:!1,placeholder:"請輸入地址或地名查詢...",errorMessage:"查無此地址",geocoder:new L.Control.Geocoder.Google("AIzaSyARIN80OjEjl4O24neRkXZgAo7hTKqVhD4")}).on("markgeocode",function(e){var t=e.geocode.center,o=e.geocode.name,n=leafletPip.pointInLayer(t,c,!0),r=void 0;a&&(r=leafletPip.pointInLayer(t,s,!0));var g=leafletPip.pointInLayer(t,i,!0),f=leafletPip.pointInLayer(t,l,!0),u=leafletPip.pointInLayer(t,p,!0),m=leafletPip.pointInLayer(t,d,!0),h=n.length>0?n[0].feature.properties["分級"]:"無潛勢",y=void 0,b=void 0;a&&(y=r.length>0?"是":"否"),g.length>0&&0===f.length?(b="雨量達600mm時，可能淹水",b+=g[0].feature.properties.NOTE.replace("(","").replace(")","")):g.length>0&&f.length>0?(b="雨量達200mm時(即豪雨)，可能淹水",b+=f[0].feature.properties.NOTE.replace("(","").replace(")",""),b+="<br>雨量達600mm時，可能淹水",b+=g[0].feature.properties.NOTE.replace("(","").replace(")","")):0===g.length&&f.length>0?(b="雨量達200mm時(即豪雨)，可能淹水",b+=f[0].feature.properties.NOTE.replace("(","").replace(")","")):u.length>0&&0===m.length?(b="雨量達600mm時，可能淹水",b+=u[0].feature.properties.NOTE.replace("(","").replace(")","")):u.length>0&&m.length>0?(b="雨量達200mm時(即豪雨)，可能淹水",b+=m[0].feature.properties.NOTE.replace("(","").replace(")",""),b+="<br>雨量達600mm時，可能淹水",b+=u[0].feature.properties.NOTE.replace("(","").replace(")","")):0===u.length&&m.length>0?(b="雨量達200mm時(即豪雨)，可能淹水",b+=m[0].feature.properties.NOTE.replace("(","").replace(")","")):b="無潛勢",a?O.update({name:o,l:h,s:y,w:b}):O.update({name:o,l:h,w:b})}).addTo(t);var h=L.control().setPosition("topleft");h.onAdd=function(){var e=L.DomUtil.create("button","ui compact icon button"),a=L.DomUtil.create("i","map outline icon",e);return $(a).on("click",function(){t.setView([23.1,120.3],11)}),$(a).attr("title","縮放至整個台南市"),e},h.addTo(t);var O=L.control();O.onAdd=function(){return this._div=L.DomUtil.create("table","ui table"),this.update(),this._div},O.update=function(e){e&&(this._div.innerHTML=a?'<tbody>\n        <thead><tr><th colspan="2">'+e.name+"</th></tr></thead>\n        <tr><td>地質敏感區</td><td>"+e.s+"</td></tr>\n        <tr><td>土壤液化潛勢</td><td>"+e.l+"</td></tr>\n        <tr><td>淹水潛勢</td><td>"+e.w+"</td></tr>\n        </tbody>":'<tbody>\n        <thead><tr><th colspan="2">'+e.name+"</th></tr></thead>\n        <tr><td>土壤液化潛勢</td><td>"+e.l+"</td></tr>\n        <tr><td>淹水潛勢</td><td>"+e.w+"</td></tr>\n        </tbody>")},O.addTo(t),$("#s-loadin").on("click",function(){a||($("#s-loadin").addClass("loading"),$.getJSON("./src/data/disaster-sensitive.json",function(e){o=e,s=L.geoJSON(o,{style:g}).addTo(t),$("#s-loadin").removeClass("loading"),$("#s-loadin").removeClass("basic"),$("#s-loadin").addClass("disabled"),$("#s-loadin").text("已載入地質敏感資料"),m='<span><span class="info-block" style="background-color: '+g.color+' "></span><strong>地質敏感區</strong></span>\n      <span><span class="info-block bg-liquefaction"></span><strong>土壤液化潛勢區</strong></span>\n      <span><span class="info-block bg-water"></span><strong>淹水潛勢區</strong></span>',$("#map-info").html(m)}),a=!0)})}(window);